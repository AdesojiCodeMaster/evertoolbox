
<!doctype html><html lang='en'><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="EverToolbox â€” fast, free, and elegant web utilities for creators.">
<!-- GA4 placeholder: G-XXXXXXXXXX -->
<!-- Search Console verification placeholder --><title>Zip & Unzip â€” EverToolbox</title><link rel='stylesheet' href='style.css'></head><body><header id="site-header" class="site-header" role="banner">
  <div class="container header-inner">
    <a class="brand" href="index.html" aria-label="EverToolbox home">
      <div class="logo">ET</div>
      <div class="brand-text"><span class="brand-name">EverToolbox</span><small class="muted">Smart web utilities</small></div>
    </a>
    <nav class="main-nav" role="navigation" aria-label="Main navigation">
      <ul class="nav-list">
        <li><a href="index.html">Home</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="tools.html">Tools</a></li>
        <li><a href="blog.html">Blog</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </nav>
    <div class="header-actions">
      <button id="theme-toggle" class="toggle" aria-label="Toggle theme">ðŸŒ™</button>
      <button id="mobile-menu-btn" class="mobile-menu-btn" aria-label="Open menu" aria-expanded="false">â˜°</button>
    </div>
  </div>
</header>
<nav id="mobile-menu" class="mobile-menu" aria-hidden="true">
  <ul>
    <li><a href="index.html">Home</a></li>
    <li><a href="about.html">About</a></li>
    <li><a href="tools.html">Tools</a></li>
    <li><a href="blog.html">Blog</a></li>
    <li><a href="contact.html">Contact</a></li>
  </ul>
</nav><main class='container'><article class='card'><h1>Zip & Unzip</h1><h3>Create a Zip</h3><input id='zip-files' type='file' multiple><br><button class='btn' onclick='handleZipCreate()'>Create ZIP</button><h3>Inspect a ZIP</h3><input id='unzip-file' type='file' accept='.zip'><br><button class='btn' onclick='handleZipExtract()'>Inspect ZIP</button><ul id='unzip-list'></ul></article></main><footer id="site-footer" class="site-footer" role="contentinfo">
  <div class="container footer-inner">
    <div class="footer-left">
      <strong>EverToolbox</strong><br><small class="muted">Â© 2025 EverToolbox. All rights reserved.</small>
    </div>
    <div class="footer-right">
      <a href="https://github.com/AdesojiCodeMaster" target="_blank" rel="noopener">GitHub</a>
      <a href="https://www.linkedin.com/in/adesoji-adewumi" target="_blank" rel="noopener">LinkedIn</a>
      <a href="https://twitter.com/codemas22665735" target="_blank" rel="noopener">Twitter</a>
    </div>
  </div>
</footer><script src='libs/jszip.min.js'></script><script src='script.js'></script></body></html>














<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Vanilla Zip/Unzip Demo</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <script src="https://unpkg.com/fflate@0.7.4/umd/index.js"></script>
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif; padding: 20px; max-width: 900px; margin: auto; }
    .box { border: 2px dashed #cbd5e1; padding: 20px; border-radius: 8px; text-align: center; color: #334155; }
    .box.dragover { background: #f1f5f9; border-color: #60a5fa; }
    .controls { display:flex; gap: 12px; margin: 12px 0; align-items:center; flex-wrap:wrap; }
    .file-list { margin-top: 12px; }
    .file-row { display:flex; justify-content:space-between; padding:6px 8px; border-bottom:1px solid #e2e8f0; align-items:center; }
    button { padding: 8px 12px; border-radius:6px; border:1px solid #cbd5e1; background:white; cursor:pointer; }
    input[type="range"] { width: 160px; }
    .small { font-size: 0.85rem; color: #64748b; }
    .preview { max-height: 300px; overflow:auto; margin-top:8px; border:1px solid #e2e8f0; padding:8px; border-radius:6px; background:#fff; }
  </style>
</head>
<body>
  <h1>Vanilla Zip / Unzip</h1>
  <div class="box" id="dropzone">
    Drag & drop files here, or
    <input id="fileInput" type="file" multiple style="display:inline-block; margin-left:8px;">
  </div>

  <div class="controls" style="margin-top:12px;">
    <label class="small">Compression level: <span id="levelLabel">6</span></label>
    <input id="level" type="range" min="0" max="9" value="6">
    <button id="createZipBtn">Create ZIP & Download</button>

    <div style="margin-left:auto">
      <label class="small" style="margin-right:8px">Open archive:</label>
      <input id="zipOpen" type="file" accept=".zip"/>
    </div>
  </div>

  <div id="status" class="small">No files selected.</div>

  <div class="file-list" id="fileList"></div>

  <h3>Archive Contents (when opening a .zip)</h3>
  <div id="archiveList"></div>

  <script>
    // Using fflate (umd) loaded from CDN: window.fflate
    const { zip, unzip } = window.fflate;

    const drop = document.getElementById('dropzone');
    const fileInput = document.getElementById('fileInput');
    const fileListEl = document.getElementById('fileList');
    const status = document.getElementById('status');
    const createZipBtn = document.getElementById('createZipBtn');
    const levelInput = document.getElementById('level');
    const levelLabel = document.getElementById('levelLabel');
    const zipOpen = document.getElementById('zipOpen');
    const archiveList = document.getElementById('archiveList');

    let files = []; // Array of File objects

    function renderFileList() {
      fileListEl.innerHTML = '';
      if (files.length === 0) { status.textContent = 'No files selected.'; return; }
      status.textContent = `${files.length} file(s) selected â€” total approx ${(files.reduce((s,f)=>s+f.size,0)/1024/1024).toFixed(2)} MB`;
      files.forEach((f, i) => {
        const row = document.createElement('div');
        row.className = 'file-row';
        row.innerHTML = `<div style="min-width:0"><strong style="display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${f.name}</strong><span class="small">${(f.size/1024).toFixed(1)} KB</span></div>`;
        const rm = document.createElement('button');
        rm.textContent = 'Remove';
        rm.onclick = () => { files.splice(i,1); renderFileList(); };
        row.appendChild(rm);
        fileListEl.appendChild(row);
      });
    }

    // Drag & drop handlers
    ['dragenter','dragover'].forEach(ev => drop.addEventListener(ev, e => { e.preventDefault(); drop.classList.add('dragover'); }));
    ['dragleave','drop'].forEach(ev => drop.addEventListener(ev, e => { e.preventDefault(); drop.classList.remove('dragover'); }));
    drop.addEventListener('drop', e => {
      const dt = e.dataTransfer;
      handleNewFiles(Array.from(dt.files));
    });
    fileInput.addEventListener('change', e => handleNewFiles(Array.from(e.target.files)));

    function handleNewFiles(newFiles) {
      // Remove duplicates by name+size
      newFiles.forEach(f => {
        if (!files.some(x => x.name === f.name && x.size === f.size)) files.push(f);
      });
      renderFileList();
    }

    levelInput.addEventListener('input', () => levelLabel.textContent = levelInput.value);

    // Sanitization function for entry names when extracting
    function isSafeName(name) {
      // reject absolute paths or attempts at path traversal
      if (!name) return false;
      if (name.indexOf('..') !== -1) return false;
      if (name.startsWith('/') || name.startsWith('\\')) return false;
      // Windows drive letter "C:\"
      if (/^[A-Za-z]:[\\/]/.test(name)) return false;
      return true;
    }

    // Create ZIP: read files to ArrayBuffers, pass to fflate.zip
    createZipBtn.addEventListener('click', async () => {
      if (files.length === 0) { alert('Add files first.'); return; }
      createZipBtn.disabled = true;
      status.textContent = 'Reading files...';
      try {
        // Read files and build entries
        const entries = [];
        let read = 0;
        for (const f of files) {
          const ab = await f.arrayBuffer();
          entries.push({ name: f.name, data: new Uint8Array(ab) });
          read++;
          status.textContent = `Read ${read}/${files.length} files...`;
        }

        status.textContent = 'Compressing (this may take a moment)...';
        // fflate.zip accepts an array of {name, data} and returns Uint8Array in callback
        zip(entries, { level: parseInt(levelInput.value, 10) }, (err, zipped) => {
          if (err) { alert('Error while zipping: ' + err); createZipBtn.disabled = false; return; }
          const blob = new Blob([zipped], { type: 'application/zip' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          const now = new Date().toISOString().replace(/[:.]/g,'-');
          a.download = `archive-${now}.zip`;
          document.body.appendChild(a);
          a.click();
          a.remove();
          URL.revokeObjectURL(url);
          status.textContent = 'ZIP created and downloaded.';
          createZipBtn.disabled = false;
        });
      } catch (ex) {
        alert('Unexpected error: ' + ex);
        createZipBtn.disabled = false;
        status.textContent = 'Error.';
      }
    });

    // Open zip and list entries
    zipOpen.addEventListener('change', async (e) => {
      const file = e.target.files && e.target.files[0];
      if (!file) return;
      archiveList.innerHTML = '';
      status.textContent = `Reading archive: ${file.name}`;
      try {
        const ab = await file.arrayBuffer();
        status.textContent = 'Inflating archive...';
        // unzip returns an object with filename -> Uint8Array
        unzip(new Uint8Array(ab), (err, filesMap) => {
          if (err) { alert('Error reading archive: ' + err); status.textContent = 'Error opening archive.'; return; }
          const names = Object.keys(filesMap).sort();
          if (names.length === 0) { archiveList.textContent = 'Archive empty or unsupported format.'; status.textContent = 'Opened archive.'; return; }

          status.textContent = `Archive opened (${names.length} entries).`;
          names.forEach(name => {
            const safe = isSafeName(name);
            const entry = filesMap[name];
            const row = document.createElement('div');
            row.className = 'file-row';
            const leftDiv = document.createElement('div');
            leftDiv.style.minWidth = '0';
            leftDiv.innerHTML = `<strong style="display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${name}</strong><span class="small">${entry.length} bytes ${safe ? '' : ' â€” UNSAFE PATH'}</span>`;
            row.appendChild(leftDiv);

            const btns = document.createElement('div');

            // Preview if text or image
            const mimeGuess = /\.(png|jpe?g|gif|webp|svg)$/i.test(name) ? 'image' : (/\.(txt|md|json|js|css|html?)$/i.test(name) ? 'text' : 'bin');

            if (safe) {
              if (mimeGuess === 'image') {
                const p = document.createElement('button'); p.textContent = 'Preview'; p.onclick = () => {
                  const blob = new Blob([entry]);
                  const url = URL.createObjectURL(blob);
                  const img = document.createElement('img');
                  img.src = url;
                  img.style.maxWidth = '100%';
                  img.onload = () => URL.revokeObjectURL(url);
                  showPreview(name, img);
                };
                btns.appendChild(p);
              } else if (mimeGuess === 'text') {
                const p = document.createElement('button'); p.textContent = 'Preview'; p.onclick = () => {
                  const text = new TextDecoder().decode(entry);
                  const pre = document.createElement('pre');
                  pre.textContent = text;
                  pre.style.whiteSpace = 'pre-wrap';
                  showPreview(name, pre);
                };
                btns.appendChild(p);
              }
              const d = document.createElement('button'); d.textContent = 'Download'; d.onclick = () => {
                const blob = new Blob([entry]);
                const a = document.createElement('a');
                a.href = URL.createObjectURL(blob);
                a.download = (name.split('/').pop() || name);
                document.body.appendChild(a);
                a.click();
                a.remove();
                // allow GC of objectURL when page unloads
              };
              btns.appendChild(d);
            } else {
              const warn = document.createElement('span'); warn.className = 'small'; warn.style.color = '#dc2626'; warn.textContent = 'Unsafe path â€” extraction disabled';
              btns.appendChild(warn);
            }

            row.appendChild(btns);
            archiveList.appendChild(row);
          });
        });
      } catch (ex) {
        alert('Error reading archive: ' + ex);
        status.textContent = 'Error.';
      }
    });

    function showPreview(title, node) {
      const modal = document.createElement('div');
      modal.style.position = 'fixed';
      modal.style.left = 0; modal.style.top = 0; modal.style.right = 0; modal.style.bottom = 0;
      modal.style.background = 'rgba(2,6,23,0.6)';
      modal.style.display = 'flex';
      modal.style.alignItems = 'center';
      modal.style.justifyContent = 'center';
      modal.onclick = () => modal.remove();

      const box = document.createElement('div');
      box.style.background = 'white';
      box.style.padding = '16px';
      box.style.maxWidth = '90%';
      box.style.maxHeight = '90%';
      box.style.overflow = 'auto';
      box.style.borderRadius = '8px';
      const h = document.createElement('h4'); h.textContent = title; h.style.marginTop = 0;
      box.appendChild(h);
      box.appendChild(node);
      const note = document.createElement('div'); note.className = 'small'; note.style.marginTop = '8px'; note.textContent = 'Click outside to close.';
      box.appendChild(note);
      modal.appendChild(box);
      document.body.appendChild(modal);
    }
  </script>
</body>
</html>

